# PandaWiki 本地开发启动指南

## 🎯 目标
本地运行代码，连接服务器 `10.211.55.9` 的中间件服务

## 📋 前置条件

### 1. 确保服务器服务正常运行
在服务器 `10.211.55.9` 上确保以下服务正常运行：
- PostgreSQL (端口 5432)
- Redis (端口 6379) 
- MinIO (端口 9000)
- NATS (端口 4222)
- Qdrant (端口 6333)
- RAGLite (端口 8080)

### 2. 检查网络连接
```bash
# 测试服务器连接
ping 10.211.55.9

# 测试关键端口
telnet 10.211.55.9 5432  # PostgreSQL
telnet 10.211.55.9 6379  # Redis
telnet 10.211.55.9 9000  # MinIO
```

### 3. 开发工具要求
- Go 1.24.3+
- Node.js 18+
- pnpm

## 🚀 启动方式

### 方式二：手动启动

#### 1. 启动后端服务

```bash
# 进入后端目录
cd backend

# 安装依赖
go mod tidy

# 生成代码（可选）
make generate

# 启动API服务（终端1）
go run cmd/api/main.go

# 启动消费者服务（终端2）
go run cmd/consumer/main.go
```

#### 2. 启动管理后台

```bash
# 进入管理后台目录（终端3）
cd web/admin

# 安装依赖
pnpm install

# 启动开发服务器
pnpm dev
```

#### 3. 启动用户前台

```bash
# 进入用户前台目录（终端4）
cd web/app

# 安装依赖
pnpm install

# 启动开发服务器
pnpm dev
```

## 📍 访问地址

| 服务 | 地址 | 说明 |
|------|------|------|
| 管理后台 | http://localhost:5173 | 管理界面 |
| 用户前台 | http://localhost:3000 | 用户界面 |
| 后端API | http://localhost:8080 | API服务 |

## 🔑 登录信息

- **用户名**: `admin`
- **密码**: `WHp1wNa0BAD0aPAvXtJlRnDj9b8miCWJ`

## 🔧 配置说明

### 后端配置 (`backend/.env`)
- 所有中间件服务都指向服务器 `10.211.55.9`
- 使用服务器的真实密码和配置

### 前端配置
- **管理后台** (`web/admin/.env.local`): 指向本地API `http://localhost:8080`
- **用户前台** (`web/app/.env.local`): 指向本地API `http://localhost:8080`

## 🐛 故障排除

### 1. 后端连接失败
```bash
# 检查服务器端口是否开放
telnet 10.211.55.9 5432

# 检查防火墙设置
# 确保服务器防火墙允许来自您IP的连接
```

### 2. 前端连接失败
- 确保后端API服务在 `http://localhost:8080` 正常运行
- 检查浏览器控制台是否有CORS错误

### 3. 数据库连接失败
- 确认PostgreSQL服务正常运行
- 检查用户名密码是否正确
- 确认网络连接正常

### 4. 如果本地后端启动失败
可以直接连接服务器API：

**管理后台** (`web/admin/.env.local`):
```bash
VITE_API_BASE_URL=http://10.211.55.9:8080
TARGET=http://10.211.55.9:8080
STATIC_FILE_TARGET=http://10.211.55.9:8080
SHARE_TARGET=http://10.211.55.9:8080
```

**用户前台** (`web/app/.env.local`):
```bash
NEXT_PUBLIC_API_BASE_URL=http://10.211.55.9:8080
```

## 📝 开发注意事项

1. **代码修改**: 本地代码修改会实时生效
2. **数据共享**: 使用的是服务器的数据库，数据会与服务器同步
3. **端口冲突**: 确保本地端口 8080、5173、3000 没有被占用
4. **网络稳定**: 保持与服务器的网络连接稳定

## 🛑 停止服务

- 如果使用一键启动脚本：按 `Ctrl+C`
- 如果手动启动：在每个终端按 `Ctrl+C` 停止对应服务
